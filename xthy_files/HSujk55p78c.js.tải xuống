if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("MWChatStateV2IsFlyoutOpen.bs",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a.openFlyoutWatermark!==0}f.isFlyoutOpen=a}),null);
__d("MWChatHeadPicture.bs",["ix","BaseGlimmer.react","MWChatFacepile.bs","MWChatProfile.bs","MWIcon.react","fbicon","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||b("react");c="x1cdi11e-B";var k={chatHeadIntroAnim:{animationDirection:"xpz12be",animationDuration:"x4b6v7d",animationFillMode:"x10e4vud",animationIterationCount:"x1v7wizp",animationName:"xxjl4ni",animationTimingFunction:"x84okpw"},dropShadow:{borderTopStartRadius:"x14yjl9h",borderTopEndRadius:"xudhj91",borderBottomEndRadius:"x18nykt9",borderBottomStartRadius:"xww2gxu",boxShadow:"x1qeybcx",":hover":{boxShadow:"x19xcq9t"}},headGlimmer:{borderTopStartRadius:"x14yjl9h",borderTopEndRadius:"xudhj91",borderBottomEndRadius:"x18nykt9",borderBottomStartRadius:"xww2gxu",height:"xsdox4t",position:"x1n2onr6",width:"x1useyqa"},withBackground:{backgroundColor:"xcrg951"},withOverflowBackground:{alignItems:"x6s0dn4",backgroundColor:"xcrg951",borderTopStartRadius:"x14yjl9h",borderTopEndRadius:"xudhj91",borderBottomEndRadius:"x18nykt9",borderBottomStartRadius:"xww2gxu",display:"x78zum5",height:"xsdox4t",justifyContent:"xl56j7k",width:"x1useyqa"}};function a(a){var c=a.children,d=a.images,e=a.noFacepile;a=a.noDropShadow;e=e!==void 0?e:!1;a=a!==void 0?a:!1;var f=d.length;if(f!==1)if(f!==0)if(e)return j.jsxs("div",{className:(i||(i=b("stylex")))(a?!1:k.dropShadow,k.withOverflowBackground),children:[j.jsx(b("MWIcon.react"),{icon:b("fbicon")._(g("481920"),24)}),c]});else return j.jsx(b("MWChatFacepile.bs").make,{borderBetweenImages:!1,firstParticipantURI:d[0],secondParticipantURI:d[1],shadow:!0,size:48,children:c});else return j.jsx("div",{className:(i||(i=b("stylex")))(k.withBackground,k.headGlimmer),children:j.jsx(b("BaseGlimmer.react"),{index:1,theme:"dark",children:c})});f=d[0];return j.jsx("div",{className:(i||(i=b("stylex")))(a?!1:k.dropShadow,k.chatHeadIntroAnim),children:j.jsx(b("MWChatProfile.bs").make,{size:48,src:f,children:c})})}a.displayName=a.name+" [from "+e.id+"]";d=a;f.chatheadAppear=c;f.styles=k;f.make=d}),null);
__d("MWV2ChatHeadButton.bs",["CometPressable.react","bs_caml_option","react","stylex"],(function(a,b,c,d,e,f){"use strict";var g,h,i=g||b("react"),j={button:{appearance:"xjyslct",backgroundColor:"xjbqb8w",borderTopStartRadius:"x14yjl9h",borderTopEndRadius:"xudhj91",borderBottomEndRadius:"x18nykt9",borderBottomStartRadius:"xww2gxu",height:"xsdox4t",marginTop:"xdj266r",marginEnd:"x11i5rnm",marginBottom:"xat24cr",marginStart:"x1mh8g0r",transitionDuration:"xx6bhzk",transitionProperty:"x11xpdln",transitionTimingFunction:"x9lcvmn",width:"x1useyqa"},container:{alignItems:"x6s0dn4",display:"x78zum5",height:"xsdox4t",justifyContent:"xl56j7k",marginBottom:"xyorhqc",position:"x10l6tqk",width:"x1useyqa"}};function a(a){var c=a.children;a=a.style;return i.jsx("div",{className:(h||(h=b("stylex")))(j.container),style:a,children:c})}a.displayName=a.name+" [from "+e.id+"]";d={make:a};function c(a,c){var d=a.ariaDescribedBy,e=a.ariaLabel,f=a.children,g=a.onFocusChange,h=a.onHoverChange,k=a.onHoverIn,l=a.onHoverOut,m=a.onPress;a=a.testid;f={children:f,overlayDisabled:!0,xstyle:function(a){return[j.button]}};e!==void 0&&(f["aria-label"]=b("bs_caml_option").valFromOption(e));e=c==null?void 0:b("bs_caml_option").some(c);e!==void 0&&(f.ref=b("bs_caml_option").valFromOption(e));a!==void 0&&(f.testid=b("bs_caml_option").valFromOption(a));h!==void 0&&(f.onHoverChange=b("bs_caml_option").valFromOption(h));k!==void 0&&(f.onHoverIn=b("bs_caml_option").valFromOption(k));l!==void 0&&(f.onHoverOut=b("bs_caml_option").valFromOption(l));g!==void 0&&(f.onFocusChange=b("bs_caml_option").valFromOption(g));m!==void 0&&(f.onPress=b("bs_caml_option").valFromOption(m));d!==void 0&&(f["aria-describedby"]=b("bs_caml_option").valFromOption(d));return i.jsx(b("CometPressable.react"),babelHelpers["extends"]({},f))}c.displayName=c.name+" [from "+e.id+"]";a=i.forwardRef(c);f.styles=j;f.Container=d;f.make=a}),null);
__d("MWV2ChatHeadCloseButton.bs",["fbt","ix","CometPressable.react","MWIcon.react","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||b("react"),k={closeButton:{alignItems:"x6s0dn4",backgroundColor:"xcrg951",borderTopStartRadius:"x14yjl9h",borderTopEndRadius:"xudhj91",borderBottomEndRadius:"x18nykt9",borderBottomStartRadius:"xww2gxu",display:"x78zum5",end:"x1adoouj",height:"x1qx5ct2",justifyContent:"xl56j7k",opacity:"xg01cxk",position:"x10l6tqk",top:"x1fo6t33",transform:"x1f85oc2",transitionDuration:"x19bguh7",transitionProperty:"x6o7n8i",width:"xw4jnvo"},visible:{opacity:"x1hc1fzr",transform:"x3oybdh"}};function a(a){var c=a.isVisible,d=a.onFocusChange,e=a.onHoverChange;a=a.onPress;return j.jsx(b("CometPressable.react"),{"aria-label":g._("__JHASH__SolP4Av4egw__JHASH__"),onFocusChange:d,onHoverChange:e,onPress:a,xstyle:function(a){return[k.closeButton,c||a.focused?k.visible:!1]},children:j.jsx(b("MWIcon.react"),{icon:b("fbicon")._(h("478231"),12)})})}a.displayName=a.name+" [from "+e.id+"]";c=a;f.make=c}),null);
__d("MWV2ChatHeadFlyout.bs",["fbt","CometBadge.react","LSThreadTitle.bs","Locale","MWLSThreadSnippetForDisplay","MWPIsThreadUnread.bs","MWText.react","bs_caml_option","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||b("react"),k={container:{backgroundColor:"xcrg951",borderTopStartRadius:"x1lq5wgf",borderTopEndRadius:"xgqcy7u",borderBottomEndRadius:"x30kzoy",borderBottomStartRadius:"x9jhf4c",bottom:"x1ey2m1c",boxShadow:"x1ot33o7",boxSizing:"x9f619",display:"x78zum5",end:"x92rtbv",flexDirection:"xdt5ytf",height:"xnnlda6",maxWidth:"x256u9z",minWidth:"xktpd3l",paddingEnd:"x1iji9kk",paddingStart:"x1sln4lm",position:"x10l6tqk"},containerWithSubtitle:{height:"xwzfr38"},gradientLTR:{backgroundImage:"x1ov1ned"},gradientRTL:{backgroundImage:"xwntvv8"},openChatArrowPointer:{borderTopEndRadius:"xevpo8y",bottom:"x1doy451",end:"x1923su1",height:"xlup9mm",position:"x10l6tqk",width:"x1kky2od"},openChatArrowPointerShadow:{boxShadow:"x1ot33o7"},spacer:{flexGrow:"x1iyjqo2"}},l=b("Locale").isRTL(),m=l?-45:45;function a(a){var c=a.id,d=a.subtitle;a=a.thread;var e=b("MWLSThreadSnippetForDisplay").MWLSThreadSnippetForDisplay(a),f=d!==void 0;return j.jsxs("div",{"data-testid":void 0,id:c,children:[j.jsx("div",{className:(i||(i=b("stylex")))(k.openChatArrowPointer,k.openChatArrowPointerShadow),style:{transform:"rotate("+m+"deg)"}}),j.jsxs("div",{className:i(k.container,f?k.containerWithSubtitle:!1),children:[j.jsx("div",{className:i(k.spacer)}),j.jsx("div",{"aria-hidden":!0,children:j.jsx(b("MWText.react"),{color:"primary",type:"headlineEmphasized4",numberOfLines:1,children:j.jsx(b("LSThreadTitle.bs").make,{thread:a})})}),d!==void 0?j.jsxs(j.Fragment,{children:[j.jsx("div",{className:(i||(i=b("stylex")))(k.spacer)}),j.jsx(b("MWText.react"),{color:"secondary",type:"headline4",numberOfLines:1,children:b("bs_caml_option").valFromOption(d)})]}):null,j.jsx("div",{className:i(k.spacer)}),j.jsxs(b("MWText.react"),{color:"secondary",type:"body3",numberOfLines:1,children:[b("MWPIsThreadUnread.bs").isThreadUnread(a)?j.jsx(b("CometBadge.react"),{color:"blue",label:g._("__JHASH__l0d8BOpfm06__JHASH__").toString()}):null,e]}),j.jsx("div",{className:i(k.spacer)})]}),j.jsx("div",{className:i(k.openChatArrowPointer,l?k.gradientRTL:k.gradientLTR),style:{transform:"rotate("+m+"deg)"}})]})}a.displayName=a.name+" [from "+e.id+"]";c=a;f.styles=k;f.isRTL=l;f.rotation=m;f.make=c}),null);
__d("MWV2ChatHeadTypingIndicator.bs",["MWChatTypingIndicator.bs","ReQL.bs","ReQLSubscription.bs","ServerTime","bs_caml_int64","bs_caml_splice_call","bs_curry","bs_int64","clearTimeout","react","setTimeout","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function i(a){var c=b("useReStore")();return b("ReQLSubscription.bs").useArray(h.useMemo(function(){return b("ReQL.bs").filter(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(c.table("typing_indicator")),{hd:a,tl:0}),function(a){return b("ServerTime").getMillis()<b("bs_caml_int64").to_float(a.expirationTimestampMs)})},[c,b("bs_int64").to_string(a)]))}function a(a){a=a.threadKey;var c=h.useState(function(){return!1}),d=c[1],e=i(a);h.useEffect(function(){b("bs_curry")._1(d,function(a){return e.length>0});var a=e.map(function(a){return b("bs_caml_int64").to_float(a.expirationTimestampMs)});a=b("bs_caml_splice_call").spliceApply(Math.max,[a]);a=a-b("ServerTime").getMillis();var c=b("setTimeout")(function(a){return b("bs_curry")._1(d,function(a){return!1})},a);return function(a){b("clearTimeout")(c)}},[d,e]);if(c[0])return h.jsx("div",{className:"x1td3qas x10l6tqk xl56j7k x1qx5ct2 xds687c x78zum5 x1ey2m1c xgk8upj x1qt0ttw xnhgr82 x1a2cdl4 xcrg951 x6s0dn4",children:h.jsx(b("MWChatTypingIndicator.bs").make,{})});else return null}c=a;f.make=c}),null);
__d("MWV2ChatHeadUnreadMessageCountBadge.bs",["fbt","CometNumberedBadge.react","MWPActor.bs","ReQL.bs","ReQLSubscription.bs","ReQLSuspense","bs_caml","bs_int64","react","stylex","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||b("react"),k={badgeHidden:{opacity:"xg01cxk"},badgeShrunk:{transform:"x1f85oc2"},unreadBadge:{end:"x1adoouj",position:"x10l6tqk",top:"x1fo6t33",transitionDuration:"x19bguh7",transitionProperty:"x6o7n8i"}};function l(a){var c=b("useReStore")(),d=b("MWPActor.bs").useActor(),e=b("ReQLSubscription.bs").useFirst(j.useMemo(function(){return b("ReQL.bs").map(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(c.table("threads")),{hd:a,tl:0}),function(e){var f;return b("ReQLSuspense").toArray((f=b("ReQL.bs")).filter(f.bounds(f.take(f.getKeyRange(f.fromTableDescending(c.table("messages")),{hd:a,tl:0}),20),{NAME:"greaterThan",VAL:{hd:e.lastReadWatermarkTimestampMs,tl:0}}),function(a){return b("bs_caml").i64_neq(a.senderId,d)})).length})},[c,b("bs_int64").to_string(d),b("bs_int64").to_string(a)]));if(e!==void 0)return e;else return 0}function a(a){var c=a.isVisible;a=a.threadKey;a=l(a);if(a>0)return j.jsx("div",{"aria-label":g._("__JHASH__oUEWSJWvKe9__JHASH__",[g._plural(a,"number")]),className:(i||(i=b("stylex")))(k.unreadBadge,c?!1:k.badgeHidden),children:j.jsx(b("CometNumberedBadge.react"),{value:a})});else return j.jsx("div",{"aria-hidden":!0,className:(i||(i=b("stylex")))(k.badgeHidden,k.badgeShrunk)})}c=a;f.make=c}),null);
__d("MWV2ChatHead.bs",["fbt","CometContextualLayer.react","LSMediaUrl.bs","LSMessagingThreadTypeUtil.bs","MWCMInboxHeaderCommunityGroupName.bs","MWCMThreadTypes.bs","MWChatHeadPicture.bs","MWChatStateActions.bs","MWChatStateV2.bs","MWChatStateV2IsFlyoutOpen.bs","MWFacepileBadge.bs","MWFacepileGetContactsToShow.bs","MWPActor.bs","MWPGetThreadTitle.bs","MWV2ChatHeadButton.bs","MWV2ChatHeadCloseButton.bs","MWV2ChatHeadFlyout.bs","MWV2ChatHeadTypingIndicator.bs","MWV2ChatHeadUnreadMessageCountBadge.bs","MWV2EnsureThatChatTabExists.bs","MWV2PreloadThread.bs","ReQL.bs","ReQLSubscription.bs","ReQLSuspense","SortedAsyncIterable.bs","bs_belt_Option","bs_caml_option","bs_curry","bs_int64","profilePhotoUtils","react","stylex","useCometUniqueID","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||b("react");function k(a,c){var d=b("MWPActor.bs").useActor(),e=a.threadName;if(e!==void 0)return g._("__JHASH__8WUxbAIePCk__JHASH__",[g._param("name of conversation",e)]).toString();e=b("bs_belt_Option").getWithDefault(b("MWPGetThreadTitle.bs").computeThreadTitle(void 0,a,c,d),"");return g._("__JHASH__WVlVng4Euk___JHASH__",[g._param("chat participants",e)])}function l(a,c){var d=b("MWPActor.bs").useActor(),e=b("LSMediaUrl.bs").Thread.threadPictureUrl(a);if(e!==void 0)return[e];else return b("MWFacepileGetContactsToShow.bs").getContactsToShow(a,c,d).map(function(a){return b("LSMediaUrl.bs").Contact.profilePictureUrl(a)})}var m={activeBadge:{position:"x10l6tqk"}};function n(a){var c=a.onFocusChange,d=a.onHoverChange,e=a.style,f=a.tab,g=a.thread,h=b("useReStore")(),n=b("MWChatStateV2.bs").useDispatch();a=function(a){return b("bs_curry")._1(n,b("MWChatStateActions.bs").maximizeTab(Date.now(),f.tabId))};var o=g.threadKey,p=j.useState(function(){return!1}),q=p[1];p=p[0];var r=j.useState(function(){return!1}),s=r[1];r=r[0];var t=function(a){return b("bs_curry")._1(n,b("MWChatStateActions.bs").closeTab(Date.now(),f.tabId))},u=b("LSMessagingThreadTypeUtil.bs").isSecure(g.threadType),v=b("ReQLSuspense").useArray(function(){var a;return(a=b("ReQL.bs")).take(a.leftJoin(a.getKeyRange(a.fromTableAscending(h.table("participants")),{hd:g.threadKey,tl:0}),a.fromTableAscending(h.table("contacts"))),8)},[g.threadKey]),w=j.useRef(null),x=b("MWChatStateV2IsFlyoutOpen.bs").isFlyoutOpen(f),y=b("useCometUniqueID")(),z=k(g,v);v=v.map(function(a){return a[1]});v=l(g,v);var A=b("profilePhotoUtils").getBadgeSizeAndStrokeWidth(48),B=b("profilePhotoUtils").getBadgePosition(24);u=b("MWV2PreloadThread.bs").useHook(o,u);var C=b("MWCMThreadTypes.bs").isJoinedCMThread(g.threadType);C=C?b("bs_caml_option").some(j.jsx(b("MWCMInboxHeaderCommunityGroupName.bs").make,{thread:g})):void 0;return j.jsxs(b("MWV2ChatHeadButton.bs").Container.make,{style:e,children:[j.jsxs(b("MWV2ChatHeadButton.bs").make,{ariaDescribedBy:y,ariaLabel:z,onFocusChange:function(a){b("bs_curry")._1(s,function(b){return a});return b("bs_curry")._1(c,a)},onHoverChange:function(a){b("bs_curry")._1(q,function(b){return a});return b("bs_curry")._1(d,a)},onHoverIn:u[0],onHoverOut:u[1],onPress:a,children:[j.jsx("div",{ref:w,children:j.jsxs(b("MWChatHeadPicture.bs").make,{images:v,children:[j.jsx(b("MWV2ChatHeadUnreadMessageCountBadge.bs").make,{isVisible:!p&&!r,threadKey:o}),j.jsx("div",{className:(i||(i=b("stylex")))(m.activeBadge),style:{bottom:B.bottom,left:B.left,right:B.right,transform:B.transform},children:j.jsx(b("MWFacepileBadge.bs").make,{size:A[0],thread:g})})]})}),p||r||x?j.jsx(b("CometContextualLayer.react"),{contextRef:w,children:j.jsx(b("MWV2ChatHeadFlyout.bs").make,{id:y,subtitle:C,thread:g})}):null,j.jsx(b("MWV2ChatHeadTypingIndicator.bs").make,{threadKey:o})]}),j.jsx(b("MWV2ChatHeadCloseButton.bs").make,{isVisible:p||r,onFocusChange:function(a){return b("bs_curry")._1(s,function(b){return a})},onHoverChange:function(a){return b("bs_curry")._1(q,function(b){return a})},onPress:t})]})}n.displayName=n.name+" [from "+e.id+"]";c={make:n};function a(a){var c=a.onFocusChange,d=a.onHoverChange,e=a.style,f=a.tab;a=a.threadKeyDescriptor;var g=b("useReStore")(),h=a.clientThreadKey,i=a.threadKey,k=b("bs_int64").to_string(i),l=JSON.stringify(h);b("MWV2EnsureThatChatTabExists.bs").useHook(i,a.threadType);a=b("ReQLSubscription.bs").useFirst(j.useMemo(function(){return b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(g.table("threads")),{hd:i,tl:0})},[g,k]));k=b("ReQLSubscription.bs").useFirst(j.useMemo(function(){if(h!==void 0)return b("ReQL.bs").getKeyRange(b("ReQL.bs").fromIndexAscending(g.table("threads").index("clientThreadKey")),{hd:h,tl:0});else return b("SortedAsyncIterable.bs").empty()},[g,l]));l=a!==void 0?a:k!==void 0?k:void 0;if(l!==void 0)return j.jsx(n,{onFocusChange:c,onHoverChange:d,style:e,tab:f,thread:l});else return null}d=a;f.styles=m;f.Impl=c;f.make=d}),null);